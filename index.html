<!DOCTYPE HTML>
<html lang="en">
  <head>
     <!-- bootstrap  -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <!-- All above bootsrtap -->




    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
    
    <link rel = "stylesheet" type = "text/css" href = "index.css"/>
    


  </head>
  <body>
    <div id="map"><form onclick='button_add_press("map")' class="button-to-add"><input type="button" value="+"></input></form></div>

    <div id="container">
      <form onclick="return_to_map()" method="post" enctype="multipart/form-data">
      <div class="form-group">
        <label for="photo">Photo:</label>
        <input type="file"  id ="photo" name="photo">
      </div>
      
      <input type="hidden"  id="lat" name="Lat" value="1">
      <input type="hidden"  id="lng" name="Lng" value="1">
      <input type="hidden"  id="tags" name="tags" value="">
      <br/>
      <div class="form-group">
        <label for="description">Description:</label>
        <input type="text"  id="description" name="description" value="">
      </div>
      <button type="submit" class="btn btn-default">Submit</button>
      </form>
      <div class="close">
        <button onclick='button_add_press("map")'>Close</button>
      </div>
    </div>







    <script>
      // initialize Leaflet
      var map = L.map('map').setView({lon: 0, lat: 0}, 2);
      // add the OpenStreetMap tiles
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap contributors</a>'
      }).addTo(map);
      var holding_data = [{"time": 12123123123123124,
        "image": "imageLocation",
        "description": "asdkjashdk",
        "tags": ["tag1", "tag2"]},{"time": 1212313123124,
        "image": "imagadaseLocation",
        "description": "asdkjasdasashdk",
        "tags": ["tagasd1", "tagasdas2"]},{"time": 1212313123124,
        "image": "imagadaseLocation",
        "description": "asdkjasdasashdk",
        "tags": ["tagasd1", "tagasdas2"]},{"time": 1212313123124,
        "image": "imagadaseLocation",
        "description": "asdkjasdasashdk",
        "tags": ["tagasd1", "tagasdas2"]}];
      // show the scale bar on the lower left corner
      L.control.scale().addTo(map);
      // var popup = L.popup().setLatLng(latlng).setContent().openOn(map);
      // show a marker on the map

      

      const data = "localhost:3000/all";

      // var request = new Request(data);
      // fetch(request).then(function(response) {
      //   return response.text();
      // }).then(function(text) {
      //   // console.log(text.substring(0, 30));
      //   var objectJson = JSON.parse(text);
      //   objectJson.forEach(x =>{
      //     pointOperation(x.lng,x.lat,x.data);
      //   });

      // });

      


      // console.log("Hello");

      function pointOperation(x,y,array){
        function rendersList(array) {
        var outputString="<div class=\"pop-up\">";
        array.forEach(element => {
          let post = element;
          outputString += "<div class=\"card\" style=\"width: 18rem;\">"
            outputString += "<img src=\"https://www.stylist.co.uk/images/app/uploads/2018/02/16105515/istock-499533347-1500x1000.jpg?w=1200&h=1&fit=max&auto=format%2Ccompress\" class=\"card-img-top\">"
          outputString+= "<div class=\"card-body\">"
          outputString+= "<h5 class=\"card-title\">"+post.time+"</h5>"
          outputString+= "<p class=\"card-text\">"+post.description+"</p>"
          outputString+= "<p class=\"card-text\">";
          post.tags.forEach(ele =>{
            outputString += ele+",";
          });
          outputString = outputString.substring(0,outputString.length-1);
          outputString += "</p>";
          outputString+="</div> </div>"
          outputString += "</br>"
        });
        return outputString+"</div>";
        }
        L.marker({lon: x, lat: y}).bindPopup(rendersList(holding_data)).addTo(map);
      }

      function button_add_press(value){
        var x = document.getElementById(value);
        
        if (x.style.display === "none") {
          x.style.display = "block";
          console.log("map is none")
        } else {
          x.style.display = "none";
          console.log("map is block")
        }
        // var y = document.getElementById("container");
        // console.log(y.style.display)
        // if (y.style.display === "none") {
        //   y.style.display = "block";
        //   console.log("container is none")
        // } else {
        //   y.style.display = "none";
        //   console.log("container is block")
        // }
      }
      function return_to_map(){
        var y = document.getElementById("container");
        console.log(y.style.display)
        if (y.style.display === "none") {
          y.style.display = "block";
          console.log("container is none")
        } else {
          y.style.display = "none";
          console.log("container is block")
        }
      }
    </script>
    
  </body>

<!DOCTYPE HTML>
<html lang="en">
  <head>
     <!-- bootstrap  -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <!-- All above bootsrtap -->




    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
    
    <link rel = "stylesheet" type = "text/css" href = "index.css"/>
    


  </head>
  <body>
    <div id="map"><form action="" class="button-to-add"><input type="button"></input></form></div>
    <script>
      // initialize Leaflet
      var map = L.map('map').setView({lon: 0, lat: 0}, 2);
      // add the OpenStreetMap tiles
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap contributors</a>'
      }).addTo(map);
      var holding_data = [{"time": 12123123123123124,
        "image": "imageLocation",
        "description": "asdkjashdk",
        "tags": ["tag1", "tag2"]},{"time": 1212313123124,
        "image": "imagadaseLocation",
        "description": "asdkjasdasashdk",
        "tags": ["tagasd1", "tagasdas2"]},{"time": 1212313123124,
        "image": "imagadaseLocation",
        "description": "asdkjasdasashdk",
        "tags": ["tagasd1", "tagasdas2"]},{"time": 1212313123124,
        "image": "imagadaseLocation",
        "description": "asdkjasdasashdk",
        "tags": ["tagasd1", "tagasdas2"]}];
      // show the scale bar on the lower left corner
      L.control.scale().addTo(map);
      // var popup = L.popup().setLatLng(latlng).setContent().openOn(map);
      // show a marker on the map

      const data = "localhost:3000/all";

      // var request = new Request(data);
      // fetch(request).then(function(response) {
      //   return response.text();
      // }).then(function(text) {
      //   // console.log(text.substring(0, 30));
      //   var objectJson = JSON.parse(text);
      //   objectJson.forEach(x =>{
      //     pointOperation(x.lng,x.lat,x.data);
      //   });

      // });

      console.log(JSON.parse('{  "links": {    "self": "http://example.com/articles",    "next": "http://example.com/articles?page[offset]=2",    "last": "http://example.com/articles?page[offset]=10"  },  "data": [{    "type": "articles",    "id": "1",    "attributes": {      "title": "JSON:API paints my bikeshed!"    },    "relationships": {      "author": {        "links": {          "self": "http://example.com/articles/1/relationships/author",          "related": "http://example.com/articles/1/author"        },        "data": { "type": "people", "id": "9" }      },      "comments": {        "links": {          "self": "http://example.com/articles/1/relationships/comments",          "related": "http://example.com/articles/1/comments"        },        "data": [          { "type": "comments", "id": "5" },          { "type": "comments", "id": "12" }        ]      }    },    "links": {      "self": "http://example.com/articles/1"    }  }],  "included": [{    "type": "people",    "id": "9",    "attributes": {      "firstName": "Dan",      "lastName": "Gebhardt",      "twitter": "dgeb"    },    "links": {      "self": "http://example.com/people/9"    }  }, {    "type": "comments",    "id": "5",    "attributes": {      "body": "First!"    },    "relationships": {      "author": {        "data": { "type": "people", "id": "2" }      }    },    "links": {      "self": "http://example.com/comments/5"    }  }, {    "type": "comments",    "id": "12",    "attributes": {      "body": "I like XML better"    },    "relationships": {      "author": {        "data": { "type": "people", "id": "9" }      }    },    "links": {      "self": "http://example.com/comments/12"    }  }]}'));
      // getJSON("../../data/file.json", function(json) {
      //   console.log(json); // this will show the info in firebug console 
      //   alert(json);
      // });


      // console.log("Hello");

      function pointOperation(x,y,array){
        function rendersList(array) {
        var outputString="<div class=\"pop-up\">";
        array.forEach(element => {
          let post = element;
          outputString += "<div class=\"card\" style=\"width: 18rem;\">"
            outputString += "<img src=\"https://www.stylist.co.uk/images/app/uploads/2018/02/16105515/istock-499533347-1500x1000.jpg?w=1200&h=1&fit=max&auto=format%2Ccompress\" class=\"card-img-top\">"
          outputString+= "<div class=\"card-body\">"
          outputString+= "<h5 class=\"card-title\">"+post.time+"</h5>"
          outputString+= "<p class=\"card-text\">"+post.description+"</p>"
          outputString+= "<p class=\"card-text\">";
          post.tags.forEach(ele =>{
            outputString += ele+",";
          });
          outputString = outputString.substring(0,outputString.length-1);
          outputString += "</p>";
          outputString+="</div> </div>"
          outputString += "</br>"
        });
        return outputString+"</div>";
        }
        L.marker({lon: x, lat: y}).bindPopup(rendersList(holding_data)).addTo(map);
      }
    </script>
    
  </body>
